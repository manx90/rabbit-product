import{v as l,u as g,w as m}from"./index-D3xoDb8w.js";function u(e){return console.log(e),e||""}function y(e){const a=(e.images||[]).map(u),s=u(e.imgCover),c=u(e.imgSizeChart),o=u(e.imgMeasure),r=(e.colors||[]).map(n=>({...n,imgColor:u(n.imgColor)})),t=(e.sizeDetails||[]).map(n=>({...n,quantities:(n.quantities||[]).map(i=>({...i}))}));return{...e,images:a,imgCover:s,imgSizeChart:c,imgMeasure:o,colors:r,sizeDetails:t}}const f=e=>{const a=l();return g({queryKey:["product",e],queryFn:async()=>{const s=a.getQueryData(["homeProducts"]),c=a.getQueriesData({queryKey:["categoryProducts"]});if((s==null?void 0:s.length)>0){const r=s.find(t=>String(t.id)===String(e));if(r)return console.log("Found product in home cache, no API call needed"),r}for(const[r,t]of c)if((t==null?void 0:t.length)>0){const n=t.find(i=>String(i.id)===String(e));if(n)return console.log("Found product in category cache, no API call needed"),n}console.log("Product not in cache, fetching from API");const o=await m.getAll({id:parseInt(e)});if(o!=null&&o.data&&o.data.length>0)return y(o.data[0]);throw new Error("Product not found")},enabled:!!e,staleTime:60*60*1e3})},P=(e,a,s=200)=>{const c=l();return g({queryKey:["categoryProducts",e,a],queryFn:async()=>{const o={category:e,limit:s};a&&(o.subCategory=a);const r=await m.getAll(o);let t=(r==null?void 0:r.data)||[];return t=t.map(n=>{const i=y(n);return c.setQueryData(["product",String(n.id)],i),i}),t},enabled:!!e,staleTime:60*60*1e3})};export{f as a,P as u};
