import{L as l,u as g}from"./vendor-CUEbPlo7.js";import{j as m}from"./index-CiYv5-Yo.js";function u(e){return console.log(e),e||""}function y(e){const a=(e.images||[]).map(u),i=u(e.imgCover),c=u(e.imgSizeChart),o=u(e.imgMeasure),r=(e.colors||[]).map(n=>({...n,imgColor:u(n.imgColor)})),t=(e.sizeDetails||[]).map(n=>({...n,quantities:(n.quantities||[]).map(s=>({...s}))}));return{...e,images:a,imgCover:i,imgSizeChart:c,imgMeasure:o,colors:r,sizeDetails:t}}const P=e=>{const a=l();return g({queryKey:["product",e],queryFn:async()=>{const i=a.getQueryData(["homeProducts"]),c=a.getQueriesData({queryKey:["categoryProducts"]});if((i==null?void 0:i.length)>0){const r=i.find(t=>String(t.id)===String(e));if(r)return console.log("Found product in home cache, no API call needed"),r}for(const[r,t]of c)if((t==null?void 0:t.length)>0){const n=t.find(s=>String(s.id)===String(e));if(n)return console.log("Found product in category cache, no API call needed"),n}console.log("Product not in cache, fetching from API");const o=await m.getAll({id:parseInt(e)});if(o!=null&&o.data&&o.data.length>0)return y(o.data[0]);throw new Error("Product not found")},enabled:!!e,staleTime:60*60*1e3})},h=(e,a,i=200)=>{const c=l();return g({queryKey:["categoryProducts",e,a],queryFn:async()=>{const o={category:e,limit:i};a&&(o.subCategory=a);const r=await m.getAll(o);let t=(r==null?void 0:r.data)||[];return t=t.map(n=>{const s=y(n);return c.setQueryData(["product",String(n.id)],s),s}),t},enabled:!!e,staleTime:60*60*1e3})};export{P as a,h as u};
